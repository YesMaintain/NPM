import n from"../lib/env.js";import o from"../lib/request.js";const i=async()=>{const r=n.GITHUB_USER,s=[],a=[];for(const e of(await o(`GET /users/${r}/repos`)).data)a.push({owner:r,name:e.name});for(const e of(await o(`GET /users/${r}/orgs`)).data){s.push({name:e.login});for(const t of(await o(`GET /orgs/${e.login}/repos`)).data)a.push({owner:e.login,name:t.name})}for(const e of s)await o(`PUT /orgs/${e.name}/actions/permissions`,{org:e.name,enabled_repositories:"all",allowed_actions:"all"}),await o(`PUT /orgs/${e.name}/actions/permissions/workflow`,{org:e.name,default_workflow_permissions:"write",can_approve_pull_request_reviews:!0});for(const e of a)await o(`PUT /repos/${e.owner}/${e.name}/vulnerability-alerts`),await o(`PUT /repos/${e.owner}/${e.name}/automated-security-fixes`),await o(`PATCH /repos/${e.owner}/${e.name}`,{has_issues:!0,has_projects:!1,has_wiki:!1,allow_squash_merge:!0,allow_merge_commit:!0,allow_rebase_merge:!1,allow_auto_merge:!0,delete_branch_on_merge:!0,allow_update_branch:!0,use_squash_pr_title_as_default:!0,allow_forking:!0,web_commit_signoff_required:!0}),await o(`PUT /repos/${e.owner}/${e.name}/actions/permissions`,{enabled:!0,allowed_actions:"all"}),await o(`PUT /repos/${e.owner}/${e.name}/actions/permissions/workflow`,{default_workflow_permissions:"write",can_approve_pull_request_reviews:!0}),await o(`PUT /user/starred/${e.owner}/${e.name}`),await o(`PUT /repos/${e.owner}/${e.name}/actions/permissions/access`,{access_level:"organization"})};var _=i;export{_ as default};
